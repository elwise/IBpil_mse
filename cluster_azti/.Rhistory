up=c(segrec2)*qlnorm(0.975, 0, residsd_low2),
case="without2019")
dat3 <- data.frame(
ssb=seq(0, max(SR@ssb), length.out=20000),
rec=c(segrec3),
low=c(segrec3)*qlnorm(0.025, 0, residsd_med),
up=c(segrec3)*qlnorm(0.975, 0, residsd_med),
case="med")
dat <- rbind(dat1, dat2,dat3)
p <- ggplot(dat, aes(ssb, rec, fill=case, col=case))+
geom_line(lwd=1.5)+
geom_ribbon(aes(ssb, ymin=low, ymax=up), alpha=0.3, linetype="dashed")+
xlab("SSB")+
ylab("Rec")+
geom_point(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec, label=year), inherit.aes = F)
print(p)
# LEIRE: from here onwards
# comparison of two recruitment scenarios:
dat1 <- data.frame(
ssb=seq(0, max(SR@ssb), length.out=20000),
rec=c(segrec),
low=c(segrec)*qlnorm(0.025, 0, residsd_low),
up=c(segrec)*qlnorm(0.975, 0, residsd_low),
case="Low")
dat2 <- data.frame(
ssb=seq(0, max(SR@ssb), length.out=20000),
rec=c(segrec2),
low=c(segrec2)*qlnorm(0.025, 0, residsd_low2),
up=c(segrec2)*qlnorm(0.975, 0, residsd_low2),
case="without2019")
dat3 <- data.frame(
ssb=seq(0, max(SR@ssb), length.out=20000),
rec=c(segrec3),
low=c(segrec3)*qlnorm(0.025, 0, residsd_med),
up=c(segrec3)*qlnorm(0.975, 0, residsd_med),
case="Medium")
dat <- rbind(dat1, dat3)
p <- ggplot(dat, aes(ssb, rec, fill=case, col=case))+
geom_line(lwd=1.5)+
geom_ribbon(aes(ssb, ymin=low, ymax=up), alpha=0.3, linetype="dashed")+
xlab("SSB")+
ylab("Rec")+
geom_point(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec, label=year), inherit.aes = F)
print(p)
ggplot(dat, aes(ssb, rec, fill=regime, col=regime))+
geom_line(lwd=1.5)+
geom_ribbon(aes(ssb, ymin=low, ymax=up), alpha=0.3, linetype="dashed")+
xlab("SSB")+
ylab("Rec")+
geom_point(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec, label=year), inherit.aes = F)
# LEIRE: from here onwards
# comparison of two recruitment scenarios:
dat1 <- data.frame(
ssb=seq(0, max(SR@ssb), length.out=20000),
rec=c(segrec),
low=c(segrec)*qlnorm(0.025, 0, residsd_low),
up=c(segrec)*qlnorm(0.975, 0, residsd_low),
regime="Low")
dat2 <- data.frame(
ssb=seq(0, max(SR@ssb), length.out=20000),
rec=c(segrec2),
low=c(segrec2)*qlnorm(0.025, 0, residsd_low2),
up=c(segrec2)*qlnorm(0.975, 0, residsd_low2),
regime="without2019")
dat3 <- data.frame(
ssb=seq(0, max(SR@ssb), length.out=20000),
rec=c(segrec3),
low=c(segrec3)*qlnorm(0.025, 0, residsd_med),
up=c(segrec3)*qlnorm(0.975, 0, residsd_med),
regime="Medium")
dat <- rbind(dat1, dat3)
p <- ggplot(dat, aes(ssb, rec, fill=regime, col=regime))+
geom_line(lwd=1.5)+
geom_ribbon(aes(ssb, ymin=low, ymax=up), alpha=0.3, linetype="dashed")+
xlab("SSB")+
ylab("Rec")+
geom_point(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec, label=year), inherit.aes = F)
print(p)
dat
SR@range
dimnames(pil.stock)$year)
dimnames(pil.stock)$year
ggplot(dat, aes(ssb, rec, fill=regime, col=regime))+
geom_line(lwd=1.5)+
geom_ribbon(aes(ssb, ymin=low, ymax=up), alpha=0.3, linetype="dashed")+
xlab("SSB")+
ylab("Rec")+
geom_point(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec), inherit.aes = F)+ geom_text(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec,label=year), inherit.aes = F)
ggplot(dat, aes(ssb, rec, fill=regime, col=regime))+
geom_line(lwd=1.5)+
geom_ribbon(aes(ssb, ymin=low, ymax=up), alpha=0.3, linetype="dashed")+
xlab("SSB")+
ylab("Rec")+
geom_point(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec), inherit.aes = F)+ geom_text(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec,label=year))
# LEIRE: from here onwards
# comparison of two recruitment scenarios:
dat1 <- data.frame(
ssb=seq(0, max(SR@ssb), length.out=20000),
rec=c(segrec),
low=c(segrec)*qlnorm(0.025, 0, residsd_low),
up=c(segrec)*qlnorm(0.975, 0, residsd_low),
regime="Low")
dat2 <- data.frame(
ssb=seq(0, max(SR@ssb), length.out=20000),
rec=c(segrec2),
low=c(segrec2)*qlnorm(0.025, 0, residsd_low2),
up=c(segrec2)*qlnorm(0.975, 0, residsd_low2),
regime="without2019")
dat3 <- data.frame(
ssb=seq(0, max(SR@ssb), length.out=20000),
rec=c(segrec3),
low=c(segrec3)*qlnorm(0.025, 0, residsd_med),
up=c(segrec3)*qlnorm(0.975, 0, residsd_med),
regime="Medium")
dat <- rbind(dat1, dat3)
p <- ggplot(dat, aes(ssb, rec, fill=regime, col=regime))+
geom_line(lwd=1.5)+
geom_ribbon(aes(ssb, ymin=low, ymax=up), alpha=0.3, linetype="dashed")+
xlab("SSB")+
ylab("Rec")+
geom_point(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec, labeller=year), inherit.aes = F)+
geom_text(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec,label=year))
print(p)
ggplot(dat, aes(ssb, rec, fill=regime, col=regime))+
geom_line(lwd=1.5)+
geom_ribbon(aes(ssb, ymin=low, ymax=up), alpha=0.3, linetype="dashed")+
xlab("SSB")+
ylab("Rec")+
geom_point(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec, labeller=year), inherit.aes = F)+
geom_text(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec,label=year), inherit.aes = F)
# LEIRE: from here onwards
# comparison of two recruitment scenarios:
dat1 <- data.frame(
ssb=seq(0, max(SR@ssb), length.out=20000),
rec=c(segrec),
low=c(segrec)*qlnorm(0.025, 0, residsd_low),
up=c(segrec)*qlnorm(0.975, 0, residsd_low),
regime="Low")
dat2 <- data.frame(
ssb=seq(0, max(SR@ssb), length.out=20000),
rec=c(segrec2),
low=c(segrec2)*qlnorm(0.025, 0, residsd_low2),
up=c(segrec2)*qlnorm(0.975, 0, residsd_low2),
regime="without2019")
dat3 <- data.frame(
ssb=seq(0, max(SR@ssb), length.out=20000),
rec=c(segrec3),
low=c(segrec3)*qlnorm(0.025, 0, residsd_med),
up=c(segrec3)*qlnorm(0.975, 0, residsd_med),
regime="Medium")
dat <- rbind(dat1, dat3)
p <- ggplot(dat, aes(ssb, rec, fill=regime, col=regime))+
geom_line(lwd=1.5)+
geom_ribbon(aes(ssb, ymin=low, ymax=up), alpha=0.3, linetype="dashed")+
xlab("SSB")+
ylab("Rec")+
geom_point(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec), inherit.aes = F)+
geom_text(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec,label=year), inherit.aes = F)
print(p)
p
ggplot(dat, aes(ssb, rec, fill=regime, col=regime))+
geom_line(lwd=1.5)+
geom_ribbon(aes(ssb, ymin=low, ymax=up), alpha=0.3, linetype="dashed")+
xlab("SSB")+
ylab("Rec")+
geom_point(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec), inherit.aes = F)+
geom_text(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec,label=year), inherit.aes = F,vjust=-0.3)
geom_text(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec,label=year), inherit.aes = F,vjust=-0.3)
# LEIRE: from here onwards
# comparison of two recruitment scenarios:
dat1 <- data.frame(
ssb=seq(0, max(SR@ssb), length.out=20000),
rec=c(segrec),
low=c(segrec)*qlnorm(0.025, 0, residsd_low),
up=c(segrec)*qlnorm(0.975, 0, residsd_low),
regime="Low")
dat2 <- data.frame(
ssb=seq(0, max(SR@ssb), length.out=20000),
rec=c(segrec2),
low=c(segrec2)*qlnorm(0.025, 0, residsd_low2),
up=c(segrec2)*qlnorm(0.975, 0, residsd_low2),
regime="without2019")
dat3 <- data.frame(
ssb=seq(0, max(SR@ssb), length.out=20000),
rec=c(segrec3),
low=c(segrec3)*qlnorm(0.025, 0, residsd_med),
up=c(segrec3)*qlnorm(0.975, 0, residsd_med),
regime="Medium")
dat <- rbind(dat1, dat3)
ggplot(dat, aes(ssb, rec, fill=regime, col=regime))+
geom_line(lwd=1.5)+
geom_ribbon(aes(ssb, ymin=low, ymax=up), alpha=0.3, linetype="dashed")+
xlab("SSB")+
ylab("Rec")+
geom_point(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec), inherit.aes = F)+
geom_text(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec,label=year), inherit.aes = F,vjust=-0.3)
# LEIRE: from here onwards
# comparison of two recruitment scenarios:
dat1 <- data.frame(
ssb=seq(0, max(SR@ssb), length.out=20000),
rec=c(segrec),
low=c(segrec)*qlnorm(0.025, 0, residsd_low),
up=c(segrec)*qlnorm(0.975, 0, residsd_low),
regime="Low")
dat2 <- data.frame(
ssb=seq(0, max(SR@ssb), length.out=20000),
rec=c(segrec2),
low=c(segrec2)*qlnorm(0.025, 0, residsd_low2),
up=c(segrec2)*qlnorm(0.975, 0, residsd_low2),
regime="without2019")
dat3 <- data.frame(
ssb=seq(0, max(SR@ssb), length.out=20000),
rec=c(segrec3),
low=c(segrec3)*qlnorm(0.025, 0, residsd_med),
up=c(segrec3)*qlnorm(0.975, 0, residsd_med),
regime="Medium")
dat <- rbind(dat1, dat3)
ggplot(dat, aes(ssb, rec, fill=regime, col=regime))+
geom_line(lwd=1.5)+
geom_ribbon(aes(ssb, ymin=low, ymax=up), alpha=0.3, linetype="dashed")+
xlab("SSB")+
ylab("Rec")+
geom_point(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec), inherit.aes = F)+
geom_text(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec,label=year), inherit.aes = F,vjust=-0.3,size=1)
ggplot(dat, aes(ssb, rec, fill=regime, col=regime))+
geom_line(lwd=1.5)+
geom_ribbon(aes(ssb, ymin=low, ymax=up), alpha=0.3, linetype="dashed")+
xlab("SSB")+
ylab("Rec")+
geom_point(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec), inherit.aes = F)+
geom_text(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec,label=year), inherit.aes = F,vjust=-0.3,size=3)
ggplot(dat, aes(ssb, rec, fill=regime, col=regime))+
geom_line(lwd=1.5)+
geom_ribbon(aes(ssb, ymin=low, ymax=up), alpha=0.3, linetype="dashed")+
xlab("SSB")+
ylab("Rec")+
geom_point(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec), inherit.aes = F)+
geom_text(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec,label=year), inherit.aes = F,vjust=-0.3,size=3)
# LEIRE: from here onwards
# comparison of two recruitment scenarios:
dat1 <- data.frame(
ssb=seq(0, max(SR@ssb), length.out=20000),
rec=c(segrec),
low=c(segrec)*qlnorm(0.025, 0, residsd_low),
up=c(segrec)*qlnorm(0.975, 0, residsd_low),
regime="Low")
dat2 <- data.frame(
ssb=seq(0, max(SR@ssb), length.out=20000),
rec=c(segrec2),
low=c(segrec2)*qlnorm(0.025, 0, residsd_low2),
up=c(segrec2)*qlnorm(0.975, 0, residsd_low2),
regime="without2019")
dat3 <- data.frame(
ssb=seq(0, max(SR@ssb), length.out=20000),
rec=c(segrec3),
low=c(segrec3)*qlnorm(0.025, 0, residsd_med),
up=c(segrec3)*qlnorm(0.975, 0, residsd_med),
regime="Medium")
dat <- rbind(dat1, dat3)
ggplot(dat, aes(ssb, rec, fill=regime, col=regime))+
geom_line(lwd=1.5)+
geom_ribbon(aes(ssb, ymin=low, ymax=up), alpha=0.3, linetype="dashed")+
xlab("SSB")+
ylab("Recruits")+
geom_point(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec), inherit.aes = F)+
geom_text(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec,label=year), inherit.aes = F,vjust=-0.3,size=3)
# LEIRE: from here onwards
# comparison of two recruitment scenarios:
dat1 <- data.frame(
ssb=seq(0, max(SR@ssb), length.out=20000),
rec=c(segrec),
low=c(segrec)*qlnorm(0.025, 0, residsd_low),
up=c(segrec)*qlnorm(0.975, 0, residsd_low),
regime="Low")
dat2 <- data.frame(
ssb=seq(0, max(SR@ssb), length.out=20000),
rec=c(segrec2),
low=c(segrec2)*qlnorm(0.025, 0, residsd_low2),
up=c(segrec2)*qlnorm(0.975, 0, residsd_low2),
regime="without2019")
dat3 <- data.frame(
ssb=seq(0, max(SR@ssb), length.out=20000),
rec=c(segrec3),
low=c(segrec3)*qlnorm(0.025, 0, residsd_med),
up=c(segrec3)*qlnorm(0.975, 0, residsd_med),
regime="Medium")
dat <- rbind(dat1, dat3)
ggplot(dat, aes(ssb, rec, fill=regime, col=regime))+
geom_line(lwd=1.5)+
geom_ribbon(aes(ssb, ymin=low, ymax=up), alpha=0.3, linetype="dashed")+
xlab("SSB")+
ylab("Recruits")+
geom_point(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec), inherit.aes = F)+
geom_text(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec,label=year), inherit.aes = F,vjust=-0.3,size=3)
ggplot(dat, aes(ssb, rec, fill=regime, col=regime))+
geom_line(lwd=1.5)+
geom_ribbon(aes(ssb, ymin=low, ymax=up), alpha=0.3, linetype="dashed")+
xlab("SSB")+
ylab("Recruits")+
geom_point(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec), inherit.aes = F)+
geom_text(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec,label=year), inherit.aes = F,vjust=-0.3,size=3)
getwd()
ggsave('SR_Low&Med.png')
ggplot(dat, aes(ssb, rec, fill=regime, col=regime))+
geom_line(lwd=1.5)+
geom_ribbon(aes(ssb, ymin=low, ymax=up), alpha=0.3, linetype="dashed")+
xlab("SSB")+
ylab("Recruits")+
geom_point(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec), inherit.aes = F)+
geom_text(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec,label=year), inherit.aes = F,vjust=-0.3,size=2)
ggsave('SR_Low&Med.png',width=5)
ggsave('SR_Low&Med.png',width=7,height = 5)
ggplot(dat, aes(ssb, rec, fill=regime, col=regime))+
geom_line(lwd=1.5)+
geom_ribbon(aes(ssb, ymin=low, ymax=up), alpha=0.3, linetype="dashed")+
xlab("SSB")+
ylab("Recruits")+
geom_point(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec), inherit.aes = F)+
geom_text(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec,label=year), inherit.aes = F,vjust=-0.3,size=2)
ggplot(dat, aes(ssb, rec, fill=regime, col=regime))+
geom_line(lwd=1)+
geom_ribbon(aes(ssb, ymin=low, ymax=up), alpha=0.3, linetype="dashed")+
xlab("SSB")+
ylab("Recruits")+
geom_point(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec), inherit.aes = F)+
geom_text(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec,label=year), inherit.aes = F,vjust=-0.3,size=2)
ggsave('SR_Low&Med.png',width=7,height = 5)
ggplot(dat, aes(ssb, rec, fill=regime, col=regime))+
geom_line(lwd=1)+
geom_ribbon(aes(ssb, ymin=low, ymax=up), alpha=0.3, linetype="dashed")+
xlab("SSB")+
ylab("Recruits")+
geom_point(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec), inherit.aes = F)+
geom_text(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec,label=year), inherit.aes = F,vjust=-0.3,size=2)
ggplot(dat1, aes(ssb, rec, fill=regime, col=regime))+
geom_line(lwd=1)+
geom_ribbon(aes(ssb, ymin=low, ymax=up), alpha=0.3, linetype="dashed")+
xlab("SSB")+
ylab("Recruits")+
geom_point(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec), inherit.aes = F)+
geom_text(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec,label=year), inherit.aes = F,vjust=-0.3,size=2)
dat1
dat1 <- data.frame(
ssb=seq(0, 337448, length.out=20000),
rec=c(segrec),
low=c(segrec)*qlnorm(0.025, 0, residsd_low),
up=c(segrec)*qlnorm(0.975, 0, residsd_low),
regime="Low")
dat3 <- data.frame(
ssb=seq(337448, max(SR@ssb), length.out=20000),
rec=c(segrec3),
low=c(segrec3)*qlnorm(0.025, 0, residsd_med),
up=c(segrec3)*qlnorm(0.975, 0, residsd_med),
regime="Medium")
dat <- rbind(dat1, dat3)
ggplot(dat1, aes(ssb, rec, fill=regime, col=regime))+
geom_line(lwd=1)+
geom_ribbon(aes(ssb, ymin=low, ymax=up), alpha=0.3, linetype="dashed")+
xlab("SSB")+
ylab("Recruits")+
geom_point(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec), inherit.aes = F)+
geom_text(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec,label=year), inherit.aes = F,vjust=-0.3,size=2)
ggplot(dat1, aes(ssb, rec, fill=regime, col=regime))+
geom_line(lwd=1)+
geom_ribbon(aes(ssb, ymin=low, ymax=up), alpha=0.3, linetype="dashed")+
xlab("SSB")+
ylab("Recruits")+
geom_point(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec), inherit.aes = F)+
geom_text(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec,label=year), inherit.aes = F,vjust=-0.3,size=2)
ggplot(dat1, aes(ssb, rec, fill=regime, col=regime))+
geom_line(lwd=1)+
geom_ribbon(aes(ssb, ymin=low, ymax=up), alpha=0.3, linetype="dashed")+ geom_line(data=dat3,lwd=1)+geom_ribbon(dat3,aes(ssb, ymin=low, ymax=up), alpha=0.3, linetype="dashed")+
xlab("SSB")+
ylab("Recruits")+
geom_point(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec), inherit.aes = F)+
geom_text(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec,label=year), inherit.aes = F,vjust=-0.3,size=2)
ggplot(dat1, aes(ssb, rec, fill=regime, col=regime))+
geom_line(lwd=1)+
geom_ribbon(aes(ssb, ymin=low, ymax=up), alpha=0.3, linetype="dashed")+ geom_line(data=dat3,lwd=1,aes(ssb, rec, fill=regime, col=regime))+geom_ribbon(dat3,aes(ssb, ymin=low, ymax=up), alpha=0.3, linetype="dashed")+
xlab("SSB")+
ylab("Recruits")+
geom_point(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec), inherit.aes = F)+
geom_text(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec,label=year), inherit.aes = F,vjust=-0.3,size=2)
ggplot(dat1, aes(ssb, rec, fill=regime, col=regime))+
geom_line(lwd=1)+
geom_ribbon(aes(ssb, ymin=low, ymax=up), alpha=0.3, linetype="dashed")+
geom_line(data=dat3,aes(ssb, rec, fill=regime, col=regime))+
geom_ribbon(dat3,aes(ssb, ymin=low, ymax=up), alpha=0.3, linetype="dashed")+
xlab("SSB")+
ylab("Recruits")+
geom_point(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec), inherit.aes = F)+
geom_text(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec,label=year), inherit.aes = F,vjust=-0.3,size=2)
ggplot(dat1, aes(ssb, rec, fill=regime, col=regime))+
geom_line(lwd=1)+
geom_ribbon(aes(ssb, ymin=low, ymax=up), alpha=0.3, linetype="dashed")+
geom_line(data=dat3,aes(ssb, rec, fill=regime, col=regime))+
geom_ribbon(data=dat3,aes(ssb, ymin=low, ymax=up), alpha=0.3, linetype="dashed")+
xlab("SSB")+
ylab("Recruits")+
geom_point(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec), inherit.aes = F)+
geom_text(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec,label=year), inherit.aes = F,vjust=-0.3,size=2)
dat3
dat1 <- data.frame(
ssb=seq(0, 337448, length.out=20000),
rec=c(segrec),
low=c(segrec)*qlnorm(0.025, 0, residsd_low),
up=c(segrec)*qlnorm(0.975, 0, residsd_low),
regime="Low")
dat3 <- data.frame(
ssb=seq(0, max(SR@ssb), length.out=20000),
rec=c(segrec3),
low=c(segrec3)*qlnorm(0.025, 0, residsd_med),
up=c(segrec3)*qlnorm(0.975, 0, residsd_med),
regime="Medium")
ggplot(dat1, aes(ssb, rec, fill=regime, col=regime))+
geom_line(lwd=1)+
geom_ribbon(aes(ssb, ymin=low, ymax=up), alpha=0.3, linetype="dashed")+
geom_line(data=dat3,aes(ssb, rec, fill=regime, col=regime))+
geom_ribbon(data=dat3,aes(ssb, ymin=low, ymax=up), alpha=0.3, linetype="dashed")+
xlab("SSB")+
ylab("Recruits")+
geom_point(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec), inherit.aes = F)+
geom_text(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec,label=year), inherit.aes = F,vjust=-0.3,size=2)
ggplot(dat1, aes(ssb, rec, fill=regime, col=regime))+
geom_line(lwd=1)+
geom_ribbon(aes(ssb, ymin=low, ymax=up), alpha=0.3, linetype="dashed")+
geom_line(data=subset(dat3,ssb>=337448),aes(ssb, rec, fill=regime, col=regime))+
geom_ribbon(data=subset(dat3,ssb>=337448),aes(ssb, ymin=low, ymax=up), alpha=0.3, linetype="dashed")+
xlab("SSB")+
ylab("Recruits")+
geom_point(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec), inherit.aes = F)+
geom_text(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec,label=year), inherit.aes = F,vjust=-0.3,size=2)
ggplot(dat1, aes(ssb, rec))+
geom_line(lwd=1)+
geom_ribbon(aes(ssb, ymin=low, ymax=up), alpha=0.3, linetype="dashed")+
geom_line(data=subset(dat3,ssb>=337448),aes(ssb, rec))+
geom_ribbon(data=subset(dat3,ssb>=337448),aes(ssb, ymin=low, ymax=up), alpha=0.3, linetype="dashed")+
xlab("SSB")+
ylab("Recruits")+
geom_point(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec), inherit.aes = F)+
geom_text(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec,label=year), inherit.aes = F,vjust=-0.3,size=2)
ggplot(dat1, aes(ssb, rec))+
geom_line(lwd=1)+
geom_ribbon(aes(ssb, ymin=low, ymax=up), alpha=0.2, linetype="dashed")+
geom_line(data=subset(dat3,ssb>=337448),aes(ssb, rec))+
geom_ribbon(data=subset(dat3,ssb>=337448),aes(ssb, ymin=low, ymax=up), alpha=0.3, linetype="dashed")+
xlab("SSB")+
ylab("Recruits")+
geom_point(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec), inherit.aes = F)+
geom_text(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec,label=year), inherit.aes = F,vjust=-0.3,size=2)
ggplot(dat1, aes(ssb, rec))+
geom_line(lwd=1)+
geom_ribbon(aes(ssb, ymin=low, ymax=up), alpha=0.1, linetype="dashed")+
geom_line(data=subset(dat3,ssb>=337448),aes(ssb, rec))+
geom_ribbon(data=subset(dat3,ssb>=337448),aes(ssb, ymin=low, ymax=up), alpha=0.1, linetype="dashed")+
xlab("SSB")+
ylab("Recruits")+
geom_point(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec), inherit.aes = F)+
geom_text(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec,label=year), inherit.aes = F,vjust=-0.3,size=2)
ggsave('SR_Mix.png',width=7,height = 5)
ggplot(dat1, aes(ssb, rec))+
geom_line(lwd=1)+
geom_ribbon(aes(ssb, ymin=low, ymax=up), alpha=0.1, linetype="dashed")+
geom_line(data=subset(dat3,ssb>=337448),aes(ssb, rec),lwd=1)+
geom_ribbon(data=subset(dat3,ssb>=337448),aes(ssb, ymin=low, ymax=up), alpha=0.1, linetype="dashed")+
xlab("SSB")+
ylab("Recruits")+
geom_point(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec), inherit.aes = F)+
geom_text(data=data.frame(ssb=c(ssb(pil.stock)), rec=c(rec(pil.stock)), year=dimnames(pil.stock)$year), aes(ssb, rec,label=year), inherit.aes = F,vjust=-0.3,size=2)
ggsave('SR_Mix.png',width=7,height = 5)
params_med
residsd_med
residsd_low2
params_low2
rm(list=ls())
#==============================================================================
# WORKING DIRECTORY                                                        ----
#==============================================================================
wd <- "D:/IPMA/SARDINE/ADVICE_MP/FLBEIA_mseIBpil/2020/cluster_azti/"
setwd(wd)
# directory with results
res.dir  <- file.path("./output_refpts")
res.plots  <- file.path("./output_refpts/plots")
#==============================================================================
# LOAD LIBRARIES AND FUNCTIONS                                             ----
#==============================================================================
library(tidyverse)
#library(cowplot)
df <- read.table(file.path(res.dir,"stats.csv"), header=T, sep=";")
rr <- 'REClow'
Bref <- 196334
df3 <- subset(df, Rule == 'HCR15' & period=='med' & Ass == "ASSss3" & Rec == rr)
max_B1plus <- df3$max_P_B1plus_Blow
df3[df3$Fscan %in% c(0.09,0.10),]
it <- approx(df3$Fscan[i-0:1],df3$Median_Catch[i-0:1])
it <- approx(df3$Fscan %in% c(0.09,0.10),df3$Median_Catch[i-0:1])
it <- approx(df3$Fscan %in% c(0.09,0.10),df3$Median_Catch[df3$Fscan %in% c(0.09,0.10)])
it <- approx(df3$Fscan[df3$Fscan %in% c(0.09,0.10)],df3$Median_Catch[df3$Fscan %in% c(0.09,0.10)])
it
i <- which.max(max_B1plus >= 0.05) # risk 3 = 0.05
#make interpolation between that position and the previous one
it <- approx(df3$Fscan[i-0:1],max_B1plus[i-0:1])
#check Fscan that corresponds to risk3 closer to 0.05
Fp05 <- icesRound(it$x[which.max(it$y >= 0.050)])
library(icesAdvice)
i <- which.max(max_B1plus >= 0.05) # risk 3 = 0.05
#make interpolation between that position and the previous one
it <- approx(df3$Fscan[i-0:1],max_B1plus[i-0:1])
#check Fscan that corresponds to risk3 closer to 0.05
Fp05 <- icesRound(it$x[which.max(it$y >= 0.050)])
it
it$x[which.max(it$y >= 0.050)]
